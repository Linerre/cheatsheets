\documentclass[10pt,a4paper,landscape]{article}
\input{preamble}

\begin{document}
% Suppress page number for all pages
\pagestyle{empty}
% Each section goes into this env
\begin{multicols*}{3}
% \input{sec/LR0}
\section*{Conflicts in LR parsing}
\begin{itemize}
\item \mb{shift} the dot past the input symbol currently before the dot
\item[] Before: $X\to \lrd A\beta$; After: $X\to A\lrd\beta$
\item \mb{reduce}: when dot at the end of item, RHS of the production can be replaced with the LHS
\item In a state $I$, expect to have either a reduce or a shift action, not both. Otherwise, there is a \mo{conflict}:
  \begin{enumerate}
  \item \mb{S}/\mb{R} conflict: state $I$ has a reduce \textbf{AND} a shift action
  \item \mb{R}/\mb{R} conflict: state $I$ has two reduce actions
  \end{enumerate}
\end{itemize}
\section*{Example: A grammar with S/R conflict}
\begin{align*}
  S&\to E\$   \tag{0} \\
  E&\to T + E \tag{1} \\
  E&\to T     \tag{2} \\
  T&\to x     \tag{3}
\end{align*}
\section*{DFA with R/S conflict}
\begin{tikzpicture}
  % I1
  \node (i1) [lrst, anchor=north east] {
    $S\to \lrd E\$$\\
    $E\to \lrd T + E$\\
    $E\to \lrd T$\\
    $T\to \lrd x$
  };
  \node [above=1mm of i1.north east, font=\footnotesize\bf]{1};

  %I2
  \node (i2) [lrst, right=12mm of i1.north east, anchor=north west] {
    $S\to E\lrd\$$
  };
  \node (m2) [above=1mm of i2.north east, font=\footnotesize\bf]{2};

  %I3
  \node (i3) [lrst, right=12mm of i1.east, anchor=north west] {
    $E\to T\lrd + E$\\
    $E\to T\lrd $
  };
  \node (m3) [right=1mm of i3.north east, font=\footnotesize\bf]{3};

  %I5
  \node (i5) [lrst, below=15mm of i1.south, anchor=north] {
    $T\to x\lrd$
  };
  \node (m5) [above=1mm of i5.north east, font=\footnotesize\bf]{5};

  %I4
  \node (i4) [lrst, below=6mm of i3, anchor=north] {
    $E\to T + \lrd E$\\
    $E\to \lrd T$\\
    $E\to \lrd T + E$ \\
    $T\to \lrd x$
  };
  \node (m4) [right=1mm of i4.north east, font=\footnotesize\bf]{4};

  %I6
  \node (i6) [lrst, right=10mm of i4, anchor=west] {
    $E\to T + E\lrd$
  };
  \node (m6) [above=1mm of i6.north east, font=\footnotesize\bf]{6};

  % note
  \node(note)[right=8mm of i3.north east, anchor=west, text width=3cm, font=\small] {
    In $I_3$, there is a shift action (over $+$) and a reduce action (dot at the end) $\to$ S/R conflict in $I_3$ and \mr{not} a LR(0) grammar
  };

  % paths
  \draw[->] (i1.east |- i2.west) -- (i2.west) node[midway, above]{$E$}  ;
  \draw[->] (i1.mid east |- i3.west) -- (i3.west) node[midway, above]{$T$}  ;
  \draw[->] (i1) edge node[left]{$x$} (i5) ;
  \draw[->]
  ([xshift=4mm]i3.south) -- ([xshift=4mm]i4.north) node[midway,right] {$+$};
  \draw[->]
  ([xshift=-4mm]i4.north) -- ([xshift=-4mm]i3.south) node[midway,left] {$T$};
  \draw[->] (i4) edge node[above]{$E$} (i6);
  \draw[->] (i4.west |- i5.east) -- (i5.east) node[midway, above]{$x$};

\end{tikzpicture}
\section*{Parse table with R/S conflict}
\begin{minipage}{.7\linewidth}
\begin{center}
\begin{tabular}{l|lll|ll}
  State &\multicolumn{3}{c}{Action$^1$} & \multicolumn{2}{c}{Goto$^2$}  \\
  \hline
  $I$ & + & $x$  &\$       & $T$ & $E$  \\
  \hline
   1  &   & $s5$ &         &$g3$& $g2$ \\
   2  &   &      &$a$      && \\
   3  &$s4,r2$&$r2$&$r2$   && \\
   4  &   &$s5$&           &$g3$&$g6$ \\
   5  &$r3$&$r3$&$r3$      &    & \\
   6  &$r1$&$r1$&$r1$      &    & \\
  \hline
  \multicolumn{6}{l}{\footnotesize 1: Action (s/r) only on terminals and \$}\\
  \hline
  \multicolumn{6}{l}{\footnotesize 2: Goto only on non-terminals}\\
  \hline
\end{tabular}
\end{center}
\end{minipage}
\begin{minipage}{.3\linewidth}
  {\small
    In state 3, on symbol +, there is a duplicate entry: The parser must shift
    into state 4 and also reduce by production 2. This is a conflict and indicates
    that the grammar is not LR(0).
  }
\end{minipage}
\section*{Use FOLLOW to build SLR and remove S/R conflict}
\begin{enumerate}
\item in each state $I$, identify all the reduce items like $A\to \alpha\lrd$ (dot at the end) where $\alpha \in \Sigma$ (terminals plus \$).
  \begin{itemize}
  \item In $I_2$, $S\to E\lrd\$$
  \item In $I_3$, $E\to T\lrd$
  \item In $I_5$, $T\to x\lrd$
  \item In $I_6$, $E\to T + E\lrd$
  \end{itemize}
\item for each reduce item above, compute \textsf{FOLLOW}(LHS)
  \begin{itemize}
  \item $\mfn{follow}(S) = \mset{\$}$ (just init the set to include \$)
  \item $\mfn{follow}(T) = \mfn{follow}(E) \cup \mfn{first}(+) = \mset{+,\$}$
  \item $\mfn{follow}(E) = \mset{\$}$
  \end{itemize}
\item for each token $X$ in each computed follow set above, put a reduce action $(I, X, A\to \alpha)$ (on lookahead $X$, reduce by rule $A\to \alpha$) in SLR table
  \begin{itemize}
  \item $(I_2, \$, S\to E\$)$, put $a$ ($r0$) at $(I_2, \$)$
  \item $(I_3, \$, E\to T)$, put $r2$ at $(I_3, \$)$
  \item $(I_5, +, T\to x)$, put $r3$ at $(I_5, +)$
  \item $(I_5, \$, T\to x)$, put $r3$ at $(I_5, \$)$
  \item $(I_6, \$, E\to T + E)$, put $r1$ at $(I_6, \$)$
  \end{itemize}
\end{enumerate}
\begin{center}
\begin{tabular}{l|lll|ll}
  State &\multicolumn{3}{c}{Action} & \multicolumn{2}{c}{Goto}  \\
  \hline
  $I$ & + & $x$  &\$       & $T$ & $E$  \\
  \hline
   1  &   & $s5$ &         &$g3$& $g2$ \\
   2  &   &      &$a$      &    & \\
   3  &$s4$&     &$r2$     && \\
   4  &   &$s5$&           &$g3$&$g6$ \\
   5  &$r3$&&$r3$          &    & \\
   6  &    &    &$r1$      &    & \\
  \hline
\end{tabular}
\end{center}

\end{multicols*}
\end{document}
